<!DOCTYPE html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂøÉÁêÜÊ∏¨È©óÔºöËß£Èéñ‰Ω†ÁöÑ Galaxy ÂéüÂûã‰∫∫Ê†º</title>
    
    <!-- START: GA4 Global Site Tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-631RLVDD3T"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-631RLVDD3T');
    </script>
    <!-- END: GA4 Global Site Tag (gtag.js) -->

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- NEW: Tone.js for sound effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0c0a18; /* Darker base for canvas */
        }
        .galaxy-background {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: -2;
        }
        .fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
            opacity: 0;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in-left {
            animation: slideInLeft 0.5s ease-out forwards;
            opacity: 0;
        }
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .option-btn {
            transition: all 0.25s ease-in-out;
            border: 2px solid transparent;
            background-color: #ffffff;
            box-shadow: 0 4px 15px -5px rgba(0, 0, 0, 0.08);
        }
        .option-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px -5px rgba(79, 70, 229, 0.15);
            border-color: #6366f1; /* Indigo */
        }
        .primary-btn {
            background: linear-gradient(45deg, #6366f1, #a855f7); /* Indigo to Purple */
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.2);
        }
        .primary-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }
        .result-bg-A { background: linear-gradient(135deg, #4b5563 0%, #1f2937 100%); } /* Black/Grey */
        .result-bg-B { background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); }
        .result-bg-C { background: linear-gradient(135deg, #dbeafe 0%, #93c5fd 100%); } /* Light Blue */
        .result-bg-D { background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%); } /* Silver */

        #start-button-container {
            position: absolute;
            width: 100%;
            padding-left: 2rem;
            padding-right: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center; /* Center the button */
            bottom: 35%; 
        }

        #start-button {
            max-width: 130px; 
            padding: 0.75rem 1rem; 
            font-size: 1rem; 
            white-space: nowrap; 
            animation: pulse 1.5s infinite alternate; 
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        /* Desktop: Override for landscape screens */
        @media (min-width: 768px) and (orientation: landscape) {
            #start-button-container {
                bottom: 4rem; 
            }
            #start-button {
                max-width: 320px; 
                padding: 1rem 2rem; 
                font-size: 1.125rem; 
                animation: none;
            }
        }
        
        /* NEW: Override for large portrait screens like digital signage */
        @media (min-width: 768px) and (orientation: portrait) {
            #start-button-container {
                bottom: 28%; /* MODIFIED: Moved button lower for signage */
            }
            #start-button {
                max-width: 325px; /* 130px * 2.5 = 325px */
                padding: 1.5rem 3rem; /* Increase padding for a larger button */
                font-size: 1.5rem; /* Increase font size */
                animation: none; /* Disable pulse on large screens */
            }
            #quiz-content-wrapper {
                align-items: flex-start;
                padding-top: 15vh;
            }
        }

        #mute-btn {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 100;
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            padding: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #mute-btn:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }

        .coupon-animate {
            animation: coupon-pulse 3s infinite;
        }
        @keyframes coupon-pulse {
            0% { box-shadow: 0 0 15px rgba(99, 102, 241, 0.2); }
            50% { box-shadow: 0 0 25px rgba(99, 102, 241, 0.5); }
            100% { box-shadow: 0 0 15px rgba(99, 102, 241, 0.2); }
        }
    </style>
</head>
<body class="relative">
    <canvas id="galaxy-background" class="galaxy-background"></canvas>

    <div id="quiz-app" class="w-full">

        <div id="start-screen" class="relative w-full h-screen fade-in-up flex flex-col justify-center items-center"
             style="background-image: url('https://raw.githubusercontent.com/andyhhsu/Galaxy-Archetype-Quiz/main/pic2.png'); background-size: cover; background-position: center;">

            <div id="start-button-container">
                <button id="start-button" onclick="startQuiz()" class="primary-btn text-white font-bold rounded-full">
                    ÈñãÂßãÊ∏¨È©ó
                </button>
            </div>
        </div>

        <div id="quiz-content-wrapper" class="hidden p-4">
            <div class="w-full max-w-xl mx-auto">
                <div id="quiz-screen" style="display: none;">
                     <div class="bg-white rounded-3xl shadow-2xl shadow-indigo-100 p-6 md:p-8 min-h-[550px] flex flex-col">
                        <div class="flex-shrink-0">
                            <div class="flex justify-between items-center mb-4">
                                <h2 class="text-xl font-bold text-indigo-600">Question <span id="question-number">1</span>/5</h2>
                                <div class="w-full bg-gray-200 rounded-full h-3 ml-4">
                                    <div id="progress-bar" class="bg-indigo-500 h-3 rounded-full transition-all duration-500" style="width: 20%"></div>
                                </div>
                            </div>
                            <p id="question-text" class="text-lg md:text-xl font-bold text-slate-800 mb-8 min-h-[60px]"></p>
                        </div>
                        <div id="options-container" class="space-y-4 flex-grow flex flex-col justify-center"></div>
                    </div>
                </div>

                <div id="tiebreaker-screen" style="display: none;">
                     <div class="bg-white rounded-3xl shadow-2xl shadow-indigo-100 p-6 md:p-8 text-center min-h-[550px] flex flex-col justify-center items-center">
                        <h2 class="text-2xl font-bold text-slate-800">ÊúÄÂæå‰∏ÄÊ≠•ÔºÅ</h2>
                        <p id="tiebreaker-question" class="mt-3 text-slate-600 max-w-sm"></p>
                        <div id="tiebreaker-options" class="mt-8 space-y-4 w-full"></div>
                    </div>
                </div>

                <div id="result-screen" style="display: none;">
                    <div id="result-card-content" class="rounded-3xl shadow-2xl shadow-indigo-200 overflow-hidden">
                        <div class="p-8 text-center">
                            <p id="result-intro" class="font-semibold text-gray-700">‰Ω†ÁöÑ Galaxy ÂéüÂûã‰∫∫Ê†ºÊòØ...</p>
                            <h2 id="result-prototype" class="text-3xl md:text-4xl font-black mt-1 text-slate-800 whitespace-nowrap"></h2>
                            <p id="result-title" class="text-xl font-bold mt-2 text-indigo-700"></p>
                        </div>
                        <div class="px-8 flex justify-center">
                            <img id="result-image" src="" alt="ÊâãÊ©üÂúñÁâá" class="w-auto h-60 md:h-64 object-contain drop-shadow-2xl -mb-4">
                        </div>
                        <div class="bg-white/50 backdrop-blur-lg p-8 pt-12">
                            <p id="result-description" class="text-base text-gray-800 leading-relaxed text-center"></p>
                             <div class="mt-8 bg-gradient-to-br from-indigo-100 to-purple-100 border-2 border-dashed border-indigo-400 rounded-2xl p-5 coupon-animate">
                                <h3 class="text-xl font-bold text-center text-indigo-800">üéÅ Â∑≤Ëß£ÈéñÔºöÂ∞àÂ±¨Á∑ö‰∏ãÂ•ΩÁ¶Æ</h3>
                                <div class="flex flex-col md:flex-row items-center gap-4 mt-4">
                                    <div class="flex-shrink-0">
                                        <img src="https://raw.githubusercontent.com/andyhhsu/Galaxy-Archetype-Quiz/main/000001_1669964223-removebg-preview.png" alt="7-ELEVEN ÁèæËêÉËå∂" class="w-36 h-36 md:w-48 md:h-48 object-contain">
                                    </div>
                                    <div class="text-center md:text-left flex-grow">
                                        <p class="font-semibold">ÊÜëÊ≠§ÁµêÊûúÁï´Èù¢ÔºåÂç≥ÂèØÂÖåÊèõÔºö</p>
                                        <p class="mt-1 text-3xl font-bold text-indigo-600 whitespace-nowrap">7-ELEVEN ÁèæËêÉËå∂</p>
                                    </div>
                                </div>
                                <div class="mt-4 border-t border-dashed border-indigo-300 pt-4 text-xs md:text-sm text-slate-700 space-y-2">
                                    <div class="flex">
                                        <span class="font-bold mr-2 flex-shrink-0">ÂÖåÊèõÂú∞Èªû:</span>
                                        <a href="https://www.google.com/maps/search/?api=1&query=ÂæÆÈ¢®ÂçóÂ±±‰∏âÊòüÊóóËâ¶È´îÈ©óÈ§®" target="_blank" class="text-indigo-600 hover:underline flex items-center">
                                            <span>„ÄêÂæÆÈ¢®ÂçóÂ±±‰∏âÊòüÊóóËâ¶È´îÈ©óÈ§®„Äë</span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0l-4.243-4.243a2 2 0 112.828-2.828L12.586 4.586z" clip-rule="evenodd" />
                                                <path fill-rule="evenodd" d="M7.414 15.414a2 2 0 11-2.828-2.828l3-3a2 2 0 012.828 0l4.243 4.243a2 2 0 01-2.828 2.828L7.414 15.414z" clip-rule="evenodd" />
                                            </svg>
                                        </a>
                                    </div>
                                    <div class="flex">
                                        <span class="font-bold mr-2 flex-shrink-0">ÂÖåÊèõÊúüÈôê:</span>
                                        <span>‚ö†Ô∏è Ë´ãÊñº 2025/7/24 ÂâçÂÖåÊèõÂÆåÁï¢</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 text-center">
                        <button onclick="restartQuiz()" class="w-full max-w-xs mx-auto bg-white text-indigo-600 font-bold py-3 px-8 rounded-full hover:bg-slate-200 transition-colors duration-300 shadow-lg">
                            ÂÜçÊ∏¨‰∏ÄÊ¨°
                        </button>
                    </div>

                    <div id="new-promotion-block" class="mt-6 bg-white border-2 border-dashed border-teal-400 rounded-2xl p-6 text-center shadow-lg">
                        <h3 class="text-2xl font-bold text-teal-600 whitespace-nowrap">üéâÁ•ûÁßòÂΩ©ËõãÔºÅ</h3>
                        <p class="mt-2 text-slate-700 font-semibold">Âç≥Êó•Ëµ∑Ëá≥ 2025/7/24ÔºåÂÆåÊàêÊñ∞Ê©üÈ†êÁÜ±ÂïèÂç∑ÔºåÂ∞±ÊúâÊ©üÊúÉÊäΩ‰∏≠ Galaxy Fit3„ÄÅÁÑ°Á∑öÈñÉÂÖÖÂÖÖÈõªÊùøÁ≠âÁ≤æÁæéÂ•ΩÁ¶ÆÔºÅ</p>
                        <a href="https://www.de-hm.com/20/262?test_code=cd488486048b79ebb40b59da53f18a06f8f2063868b6d7998e8ad29c33b0e7b0&test_expired=1751096985"
                           target="_blank"
                           onclick="trackSurveyClick()"
                           class="mt-4 inline-block bg-teal-500 text-white font-bold py-3 px-8 rounded-full text-base hover:bg-teal-600 transition-all duration-300 transform hover:scale-105 shadow-md">
                            ÂâçÂæÄÊäΩÂ§ßÁçé
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <button id="mute-btn" onclick="toggleMute()">
            <svg id="sound-on-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
            </svg>
            <svg id="sound-off-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l-4-4m0 4l4-4" />
            </svg>
        </button>
    </div>

    <script>
        // --- NEW: Sound Effects Setup ---
        let isMuted = true;
        let soundsReady = false;
        let clickSound, revealSound, swooshSound;

        function setupSounds() {
            if (soundsReady) return;
            clickSound = new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.005, decay: 0.1, sustain: 0.01, release: 0.1 } }).toDestination();
            revealSound = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, decay: 0.2, sustain: 0.2, release: 0.5 } }).toDestination();
            swooshSound = new Tone.NoiseSynth({ noise: { type: 'white' }, envelope: { attack: 0.01, decay: 0.15, sustain: 0 } }).toDestination();
            soundsReady = true;
        }

        function playSound(sound, note, duration) {
            if (!isMuted && soundsReady) {
                if (sound === swooshSound) {
                    sound.triggerAttackRelease(duration);
                } else {
                    sound.triggerAttackRelease(note, duration);
                }
            }
        }

        const muteBtn = document.getElementById('mute-btn');
        const soundOnIcon = document.getElementById('sound-on-icon');
        const soundOffIcon = document.getElementById('sound-off-icon');

        function toggleMute() {
            isMuted = !isMuted;
            soundOnIcon.classList.toggle('hidden', isMuted);
            soundOffIcon.classList.toggle('hidden', !isMuted);
            playSound(clickSound, 'C5', '8n');
        }
        
        document.body.addEventListener('click', () => {
            if (Tone.context.state !== 'running') {
                Tone.context.resume().then(setupSounds);
            } else {
                setupSounds();
            }
        }, { once: true });


        // --- NEW: Dynamic Background Setup ---
        const canvas = document.getElementById('galaxy-background');
        const ctx = canvas.getContext('2d');
        let stars = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function createStars() {
            stars = [];
            for (let i = 0; i < 200; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    radius: Math.random() * 1.5 + 0.5,
                    vx: (Math.random() - 0.5) * 0.2,
                    vy: (Math.random() - 0.5) * 0.2,
                    opacity: Math.random() * 0.5 + 0.5
                });
            }
        }

        function animateStars() {
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#1a1a3a'); // Dark blue-purple
            gradient.addColorStop(1, '#4a2a6c'); // Lighter violet
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            stars.forEach(star => {
                star.x += star.vx;
                star.y += star.vy;

                if (star.x < 0 || star.x > canvas.width) star.vx = -star.vx;
                if (star.y < 0 || star.y > canvas.height) star.vy = -star.vy;

                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
                ctx.fill();
            });
            requestAnimationFrame(animateStars);
        }
        
        window.addEventListener('load', () => {
            resizeCanvas();
            createStars();
            animateStars();
        });
        window.addEventListener('resize', () => {
            resizeCanvas();
            createStars();
        });


        // --- Quiz Logic ---
        const quizData = [
            { question: "‰∏ÄÂÄãÂÆåÁæéÁöÑÈÄ±Êú´ÂçàÂæåÔºå‰Ω†ÊúÉÈÅ∏ÊìáÂ¶Ç‰ΩïÂ∫¶ÈÅéÔºü", options: [ { text: "ÊâæÈñìÊúâË≥™ÊÑüÁöÑÂíñÂï°Âª≥ÔºåÂæûÂÆπÂú∞ËôïÁêÜÂÆå‰∏ãÈÄ±ÁöÑÂæÖËæ¶‰∫ãÈ†ÖÔºå‰∫´Âèó‰∏ÄÂàáÁõ°Âú®ÊéåÊè°ÁöÑÊàêÂ∞±ÊÑü„ÄÇ", type: 'A' }, { text: "Ë∑üÈñ®ÂØÜÁ¥ÑÂ•Ω dress codeÔºåÂú®ÊúÄÁÜ±ÈñÄÁöÑÊâìÂç°ÈªûÔºåÊçïÊçâÂΩºÊ≠§ÊúÄ‰∏äÈè°ÁöÑÁû¨Èñì„ÄÇ", type: 'B' }, { text: "ÁÇ∫‰∫Ü‰∏çÈåØÈÅéÂÅ∂ÂÉèÁöÑÊØèÂÄãË°®ÊÉÖÔºåÂ∞±ÁÆó‰ΩçÁΩÆÂÜçÈÅ†Ôºå‰πüË¶ÅË®òÈåÑ‰∏ãÊúÄÁèçË≤¥ÁöÑËàûÂè∞Áû¨Èñì„ÄÇ", type: 'C' }, { text: "‰∏ÄË∂üË™™Ëµ∞Â∞±Ëµ∞ÁöÑÂüéÂ∏ÇÊº´ÈÅäÔºåÈö®ÊÄßÈëΩÈÄ≤ÈôåÁîüÂ∑∑ÂºÑÔºå‰∫´ÂèóÁÑ°ÈöúÁ§ôÊé¢Á¥¢ÁöÑÊ®ÇË∂£„ÄÇ", type: 'D' } ] },
            { question: "Áï∂‰Ω†Ë¶èÂäÉ‰∏ÄÂ†¥ÊóÖË°åÊôÇÔºå‰Ω†Êõ¥ÂÅèÂ•ΩÂÉè‚Ä¶", options: [ { text: "Ë°åÁ®ãË°®Â°ûÊªøÔºåÂÖ¨‰∫ãÂíåÁé©Ê®ÇÁÑ°Á∏´ÂàáÊèõÔºåÊØè‰∏ÄÂàÜÈêòÈÉΩË¶ÅÊ∑ãÊºìÁõ°Ëá¥„ÄÇ", type: 'A' }, { text: "Á≤æÂøÉË¶èÂäÉÊØè‰∏ÄÂ§©ÁöÑÁ©øÊê≠ÔºåÂõ†ÁÇ∫ÊóÖÈÄî‰∏≠ÁöÑÊØèÂÄãËßíËêΩÔºåÈÉΩÊòØÊàëÁöÑ‰º∏Â±ïÂè∞„ÄÇ", type: 'B' }, { text: "ÊääÂ§ßÈÉ®ÂàÜÈ†êÁÆóÈÉΩËä±Âú®„ÄåÈ´îÈ©ó„Äç‰∏äÔºå‰æãÂ¶ÇÊºîÂî±ÊúÉ VIP ÂçÄÊàñÂúãÂÆ∂ÂÖ¨ÂúíÁöÑÁâπÊÆäÂ∞éË¶Ω„ÄÇ", type: 'C' }, { text: "Âè™Ë®ÇÂ•ΩÊ©üÁ•®‰ΩèÂÆøÔºåÂâ©‰∏ãÁöÑ‰∫§Áµ¶ÂøÉÊÉÖÊ±∫ÂÆöÔºåÁõ∏‰ø°Á∏ΩÊúÉÊúâÊÑèÊÉ≥‰∏çÂà∞ÁöÑÈ©öÂñú„ÄÇ", type: 'D' } ] },
            { question: "Âú®Á§æÁæ§Â™íÈ´î‰∏äÔºå‰Ω†ÊúÄÂÇæÂêëÂàÜ‰∫´Âì™Á®ÆÂÖßÂÆπÔºü", options: [ { text: "ÂØåÊúâÊ¥ûË¶ãÁöÑÁî¢Ê•≠Ë∂®Âã¢ÂàÜÊûêÔºåÊàñÊòØËÉΩÂ±ïÁèæÂ∞àÊ•≠ÂΩ¢Ë±°ÁöÑÂÖßÂÆπ„ÄÇ", type: 'A' }, { text: "Á≤æÂøÉË™øËâ≤ÈÅéÁöÑÁîüÊ¥ªÁæéÂ≠∏ÁÖßÁâáÔºåÊØè‰∏ÄÂºµÈÉΩ‰ª£Ë°®ËëóÊàëÁöÑÂÄã‰∫∫ÂìÅÂë≥„ÄÇ", type: 'B' }, { text: "‰∏ÄÂºµÂçÉËºâÈõ£ÈÄ¢ÁöÑÂ•áÊôØÁÖßÔºå‰æãÂ¶ÇÁ®çÁ∏±Âç≥ÈÄùÁöÑÊµÅÊòüÈõ®ÊàñÈáéÁîüÂãïÁâ©„ÄÇ", type: 'C' }, { text: "ÂêÑÁ®ÆÂØ¶Áî®Ë≥áË®äÊàñËÆìÁîüÊ¥ªÊõ¥‰æøÂà©ÁöÑËÅ∞ÊòéÂ∞èÊäÄÂ∑ß„ÄÇ", type: 'D' } ] },
            { question: "ÈÅ∏Ë≥º‰∏Ä‰ª∂Êñ∞ÁöÑÁßëÊäÄÁî¢ÂìÅÊôÇÔºåÂì™ÂÄãÁâπÈªûÊúÄËÆì‰Ω†ÂøÉÂãïÔºü", options: [ { text: "ËÉΩÂæπÂ∫ïÈ°õË¶ÜÊàëÁöÑÂ∑•‰ΩúÊµÅÁ®ãÔºåÊèê‰æõÂâçÊâÄÊú™ÊúâÁöÑÁîüÁî¢Âäõ„ÄÇ", type: 'A' }, { text: "Ë®≠Ë®àÊòØÂê¶Áç®Áâπ„ÄÅÊôÇÂ∞öÔºåËÉΩÂê¶ÊàêÁÇ∫ÊàëÂÄã‰∫∫È¢®Ê†ºÁöÑÂª∂‰º∏„ÄÇ", type: 'B' }, { text: "ÊòØÂê¶ÊìÅÊúâÊúÄÈ†ÇÁ¥öÁöÑÂ∞àÊ•≠ÊÄßËÉΩÔºåËÉΩÊªøË∂≥ÊàëÂ∞çÂÆåÁæéÁöÑÂÅèÂü∑„ÄÇ", type: 'C' }, { text: "ËÉΩÂê¶ÁÑ°Á∏´ËûçÂÖ•ÊàëÁöÑÁîüÊ¥ªÔºåËÆì‰∏ÄÂàáÈÉΩËÆäÂæóÊõ¥ËÅ∞Êòé„ÄÅÊõ¥Á∞°ÂñÆ„ÄÇ", type: 'D' } ] },
            { question: "Â¶ÇÊûúÂèØ‰ª•Áî®‰∏ÄÁ®ÆÊñπÂºèÂΩ¢ÂÆπ‰Ω†ÁöÑÁîüÊ¥ªÂì≤Â≠∏ÔºåÈÇ£ÊúÉÊòØÔºü", options: [ { text: "„ÄåÊôÇÈñìÂ∞±ÊòØÈáëÈå¢„Äç‚Äî‚Äî ÊàëÁ∏ΩÊòØÂú®ÊÄùËÄÉÂ¶Ç‰ΩïÊúÄÂ§ßÂåñÊØè‰∏ÄÂàÜÈêòÁöÑÂÉπÂÄº„ÄÇ", type: 'A' }, { text: "„ÄåÁîüÊ¥ªË¶ÅÊúâÂÑÄÂºèÊÑü„Äç‚Äî‚Äî Êàë‰∫´ÂèóÂú®Âπ≥Âá°Êó•Â∏∏‰∏≠ÂâµÈÄ†Â±¨ÊñºËá™Â∑±ÁöÑÈñÉ‰∫ÆÊôÇÂàª„ÄÇ", type: 'B' }, { text: "„ÄåËøΩÊ±ÇÊ•µËá¥ÔºåËøë‰πéÂÅèÂü∑„Äç‚Äî‚Äî Â∞çÊñºÊàëÁÜ±ÊÑõÁöÑ‰∫ãÁâ©Ôºå99ÂàÜÈÉΩ‰∏çËÉΩÁÆóÊòØÂèäÊ†º„ÄÇ", type: 'C' }, { text: "„ÄåËÅ∞ÊòéÂ∑•‰ΩúÔºåËÄå‰∏çÊòØËæõËã¶Â∑•‰Ωú„Äç‚Äî‚Äî ÊàëÁ∏ΩËÉΩÊâæÂà∞ÊúÄÈ´òÊïàÁúÅÂäõÁöÑÊñπÊ≥ïËß£Ê±∫ÂïèÈ°å„ÄÇ", type: 'D' } ] }
        ];

        const results = {
            'A': { title: "Galaxy Fold7", prototype: "ÈÅãÁ±åÂ∏∑ÂπÑÁöÑ„ÄåÈñãÂâµËÄÖ„Äç", description: "‰Ω†ËøΩÊ±ÇÊ•µËá¥ÊïàÁéáÔºåÊòØÂ§©ÁîüÁöÑÂ§öÂ∑•ËôïÁêÜÂ§ßÂ∏´„ÄÇGalaxy Fold7 ÁöÑÊ≤âÊµ∏ÂºèÂ§ßËû¢ÂπïËàáË∂ÖËñÑÊ©üË∫´ÔºåËÆì‰Ω†Èö®ÊôÇÈö®Âú∞ÈÉΩËÉΩÂ±ïÈñãÂº∑Â§ßÁîüÁî¢ÂäõÔºåÂÆåÁæéÂ•ëÂêà‰Ω†ÁöÑÂïÜÂãôÁ≤æËã±Êú¨Ëâ≤„ÄÇ", image: "https://raw.githubusercontent.com/andyhhsu/Galaxy-Archetype-Quiz/main/pic/A.png", bgClass: "result-bg-A" },
            'B': { title: "Galaxy Flip7", prototype: "ÂºïÈ†òÊΩÆÊµÅÁöÑ„ÄåÈ¢®Ê†ºÂÆ∂„Äç", description: "‰Ω†ÊòØËá™Â∏∂ÂÖâËäíÁöÑÊôÇÂ∞öÁÑ¶ÈªûÔºåÂ∞çÁæéÊÑüÊúâËëóÊïèÈä≥Áõ¥Ë¶∫„ÄÇGalaxy Flip7 ÁöÑÁ≤æÂ∑ßË®≠Ë®àËàáÂº∑Â§ßÂ∞ÅÈù¢Ëû¢ÂπïÔºåËÆì‰Ω†ÁÑ°ÈúÄÂ±ïÈñãÊâãÊ©üÂç≥ÂèØÂø´ÈÄüËá™ÊãçÔºåËºïÈ¨ÜÂÆöÁæ©Â±¨Êñº‰Ω†ÁöÑÁç®ÁâπÈ¢®Ê†º„ÄÇ", image: "https://raw.githubusercontent.com/andyhhsu/Galaxy-Archetype-Quiz/main/pic/B.png", bgClass: "result-bg-B" },
            'C': { title: "Galaxy S25 Ultra", prototype: "ËøΩÊ±ÇÊ•µËá¥ÁöÑ„ÄåÂâµÈÄ†ÂÆ∂„Äç", description: "‰Ω†Â∞çÁ¥∞ÁØÄÊúâËëóËøë‰πéÂÅèÂü∑ÁöÑËøΩÊ±ÇÔºåÊ∏¥ÊúõÊçïÊçâÊØèÂÄã‰∏çÂÆπÈåØÈÅéÁöÑÁû¨Èñì„ÄÇGalaxy S25 Ultra ÊòØ‰Ω†ÁöÑÊºîÂî±ÊúÉÁ•ûÂô®ÔºåÊÜëËóâÂÖ∂ÁÑ°ÂèØÂåπÊïµÁöÑË∂ÖÂº∑ÈÅ†ÊãçÂäüËÉΩÔºåÂÜçÈÅ†ÁöÑËàûÂè∞ÈÉΩÊòØ‰Ω†ÁöÑÊêñÊªæÂçÄ„ÄÇ", image: "https://images.samsung.com/is/image/samsung/p6pim/tw/2501/gallery/tw-galaxy-s25-s938-sm-s9380zbgbri-544716746?imbypass=true", bgClass: "result-bg-C" },
            'D': { title: "Galaxy S25 Edge", prototype: "ËÅ∞ÊòéÁîüÊ¥ªÁöÑ„ÄåÂÖ®ËÉΩËÄÖ„Äç", description: "‰Ω†ÂãôÂØ¶„ÄÅËÅ∞Êòé‰∏îÊáÇÂæóÂπ≥Ë°°ÔºåÁ∏ΩËÉΩÊâæÂà∞ÊúÄÈ´òÊïàÁöÑÁîüÊ¥ªÊñπÂºè„ÄÇGalaxy S25 Edge ÁöÑËºïÂ∑ßÊ©üË∫´ËàáÂÖ®Êñπ‰Ωç AI ÂäüËÉΩÔºåÊòØ‰Ω†Êé¢Á¥¢ÁîüÊ¥ªÁöÑÊúÄ‰Ω≥Â§•‰º¥ÔºåËÆì‰∏ÄÂàáÈÉΩËÆäÂæóËºïÈ¨ÜÂèàÁ∞°ÂñÆ„ÄÇ", image: "https://images.samsung.com/is/image/samsung/p6pim/tw/ps_2504/gallery/tw-galaxy-s25-s937-sm-s9370zsgbri-546491968?imbypass=true", bgClass: "result-bg-D" }
        };

        let currentQuestionIndex = 0;
        let userAnswers = [];

        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const tiebreakerScreen = document.getElementById('tiebreaker-screen');
        const quizContentWrapper = document.getElementById('quiz-content-wrapper');
        
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainerEl = document.getElementById('options-container');
        const progressBarEl = document.getElementById('progress-bar');
        const tiebreakerQuestionEl = document.getElementById('tiebreaker-question');
        
        const GOOGLE_SHEET_API_URL = 'https://script.google.com/macros/s/AKfycbxr6_8Vox2BHm_kNJCeILgBHeO6vTvJqCVYNgSg84ty2FM6pOFyTq9aC4tVVMwvJdpQ/exec';

        async function trackEventToSheet(eventName, eventValue) {
            if (!GOOGLE_SHEET_API_URL) {
                console.warn('Google Sheet API URLÂ∞öÊú™Ë®≠ÂÆöÔºåÁÑ°Ê≥ïÁ¥ÄÈåÑÊï∏Êìö„ÄÇ');
                return;
            }
            try {
                await fetch(GOOGLE_SHEET_API_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ event: eventName, value: eventValue, timestamp: new Date().toISOString() }),
                });
                console.log(`Event sent to Google Sheet: ${eventName}, Value: ${eventValue}`);
            } catch (error) {
                console.error('Failed to send event to Google Sheet:', error);
            }
        }

        function trackSurveyClick() {
            playSound(clickSound, 'C5', '8n');
            gtag('event', 'survey_click', { 'event_category': 'engagement', 'event_label': 'new_model_survey' });
            trackEventToSheet('survey_click');
        }

        function triggerAnimation(element) {
            if (!element) return;
            element.classList.remove('fade-in-up');
            void element.offsetWidth; 
            element.classList.add('fade-in-up');
        }

        function startQuiz() {
            playSound(clickSound, 'C5', '8n');
            gtag('event', 'quiz_start', { 'event_category': 'engagement', 'event_label': 'galaxy_archetype_quiz' });
            currentQuestionIndex = 0;
            userAnswers = [];
            startScreen.style.display = 'none';
            quizContentWrapper.classList.remove('hidden');
            quizScreen.style.display = 'block';
            triggerAnimation(quizScreen.firstElementChild);
            showQuestion();
        }

        function showQuestion() {
            playSound(swooshSound, null, '8n');
            const questionData = quizData[currentQuestionIndex];
            questionNumberEl.textContent = currentQuestionIndex + 1;
            questionTextEl.textContent = questionData.question;
            optionsContainerEl.innerHTML = '';

            questionData.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'w-full text-left p-4 rounded-xl option-btn slide-in-left';
                button.style.animationDelay = `${index * 100}ms`;
                button.innerHTML = `<span class="font-bold text-indigo-600 mr-3">${option.type}</span> ${option.text}`;
                button.onclick = () => selectOption(option.type);
                optionsContainerEl.appendChild(button);
            });
            
            progressBarEl.style.width = `${((currentQuestionIndex + 1) / quizData.length) * 100}%`;
        }

        function selectOption(type) {
            playSound(clickSound, 'C5', '8n');
            const buttons = optionsContainerEl.querySelectorAll('button');
            buttons.forEach(btn => btn.disabled = true);
            userAnswers.push(type);
            currentQuestionIndex++;
            
            setTimeout(() => {
                if (currentQuestionIndex < quizData.length) {
                    const quizCard = quizScreen.firstElementChild;
                    quizCard.classList.remove('fade-in-up');
                    void quizCard.offsetWidth;
                    quizCard.classList.add('fade-in-up');
                    showQuestion();
                } else {
                    calculateResult();
                }
            }, 300);
        }

        function calculateResult() {
            const counts = userAnswers.reduce((acc, answer) => {
                acc[answer] = (acc[answer] || 0) + 1;
                return acc;
            }, {});
            const sortedCounts = Object.entries(counts).sort((a, b) => b[1] - a[1]);
            
            if (sortedCounts.length > 1 && sortedCounts[0][1] === sortedCounts[1][1]) {
                const tiedTypes = sortedCounts.filter(entry => entry[1] === sortedCounts[0][1]).map(entry => entry[0]);
                showTiebreaker(tiedTypes);
            } else {
                const finalResultType = sortedCounts[0][0];
                showResult(finalResultType);
            }
        }
        
        function showTiebreaker(tiedTypes) {
            quizScreen.style.display = 'none';
            tiebreakerScreen.style.display = 'block';
            triggerAnimation(tiebreakerScreen.firstElementChild);
            const tiebreakerOptionsEl = document.getElementById('tiebreaker-options');
            tiebreakerQuestionEl.textContent = "Áï∂Èù¢Â∞çÊú™Áü•ÊôÇÔºå‰Ω†Êõ¥ÂÇæÂêëÊñº...";
            tiebreakerOptionsEl.innerHTML = '';
            
            const options = [
                { text: "Áî®ÈÇèËºØÂàÜÊûêÊâÄÊúâÂèØËÉΩÊÄß", resolves: ['A', 'D'] },
                { text: "Ë∑üÈö®Áï∂‰∏ãÁöÑÁõ¥Ë¶∫ËàáÊÑüÂèó", resolves: ['B', 'C'] }
            ];

            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'w-full text-center p-4 text-white rounded-full option-btn text-lg font-bold primary-btn';
                button.textContent = option.text;
                button.onclick = () => {
                    playSound(clickSound, 'C5', '8n');
                    const finalResult = tiedTypes.find(type => option.resolves.includes(type));
                    showResult(finalResult || tiedTypes[0]);
                };
                tiebreakerOptionsEl.appendChild(button);
            });
        }

        function showResult(type) {
            playSound(revealSound, 'C6', '4n');
            gtag('event', 'quiz_complete', { 'event_category': 'milestone', 'event_label': 'galaxy_archetype_quiz', 'value': type });
            trackEventToSheet('quiz_result', type);

            const resultData = results[type];
            document.getElementById('result-title').textContent = resultData.title;
            document.getElementById('result-prototype').textContent = resultData.prototype;
            document.getElementById('result-description').textContent = resultData.description;
            document.getElementById('result-image').src = resultData.image;
            document.getElementById('result-image').alt = resultData.title;
            
            const resultCardContent = document.getElementById('result-card-content');
            resultCardContent.className = 'rounded-3xl shadow-2xl shadow-indigo-200 overflow-hidden'; 
            resultCardContent.classList.add(resultData.bgClass);

            const resultIntroEl = document.getElementById('result-intro');
            const resultPrototypeEl = document.getElementById('result-prototype');
            const resultTitleEl = document.getElementById('result-title');
            
            resultPrototypeEl.className = 'text-3xl md:text-4xl font-black mt-1 text-slate-800 whitespace-nowrap';
            resultIntroEl.className = 'font-semibold text-gray-700';
            resultTitleEl.className = 'text-xl font-bold mt-2 text-indigo-700';
            
            if (type === 'A') {
                resultIntroEl.classList.remove('text-gray-700');
                resultIntroEl.classList.add('text-gray-300');
                resultPrototypeEl.classList.remove('text-slate-800');
                resultPrototypeEl.classList.add('text-white');
                resultTitleEl.classList.remove('text-indigo-700');
                resultTitleEl.classList.add('text-indigo-300');
            }

            quizScreen.style.display = 'none';
            tiebreakerScreen.style.display = 'none';
            resultScreen.style.display = 'block';
            triggerAnimation(resultScreen);
        }

        function restartQuiz() {
            playSound(clickSound, 'C5', '8n');
            resultScreen.style.display = 'none';
            quizContentWrapper.classList.add('hidden');
            startScreen.style.display = 'flex';
            triggerAnimation(startScreen);
        }

    </script>
</body>
</html>
